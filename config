# -*- mode: sh -*-

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

. "$DIR/personal_config"

personal_config_errors=false

if [ -z "$NGGROUP_SERVER_NAME" ];
then
	echo 'Error: Constant $NGGROUP_SERVER_NAME not set in \`personal_config\`'
	personal_config_errors=true
fi

if [ -z "$NGGROUP_SERVER_ROOT_URL" ];
then
	echo 'Error: Constant $NGGROUP_ROOT_URL not set in \`personal_config\`'
	personal_config_errors=true
fi

if [ -z "$NGGROUP_SERVER_ADMIN_EMAIL" ];
then
	echo 'Error: Constant $NGGROUP_SERVER_ADMIN_EMAIL not set in \`personal_config\`'
	personal_config_errors=true
fi

if $personal_config_errors;
then
	exit 1
fi

. "$DIR/global_functions"


# if we're not in production, use the current directory
if [ -n "$_IN_PRODUCTION" ]; 
then
	HTPASS_DIR=/etc/nginx/htpasswd
else
	HTPASS_DIR=.
fi

# our standard config
SITES_DIR=$HTPASS_DIR/sites
SITES_DIR_FORMAT="$SITES_DIR/.%s.rules"
SITES_COMPLETE_DIR_FORMAT="$SITES_DIR/%s"

USER_DIR=$HTPASS_DIR/users
USER_DIR_FORMAT="$USER_DIR/.%s.rules"
USER_DIR_FORMAT_DELIM=","
USER_COMPLETE_DIR_FORMAT="$USER_DIR/%s"
USER_RULE_FORMAT="%s"


GROUP_DIR=$HTPASS_DIR/groups
GROUP_DIR_FORMAT="$GROUP_DIR/%s"
GROUP_RULE_FORMAT="@%s"
TMP_FILE=/tmp/nggrouptmp
